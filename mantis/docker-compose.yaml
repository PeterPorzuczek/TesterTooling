version: "3"

services:
  web:
    image: mantis-app
    container_name: mantis_web
    ports:
      - "8989:80"
    environment:
      # Set to 0 in production
      - MANTIS_ENABLE_ADMIN=1
      # Set master salt - generated by `cat /dev/urandom | head -c 64 | base64`
      - MASTER_SALT=0xXzPozuKIING2XGaW
      # Set base email settings, for detailed configuration (i.e. SMTP) add own config file
      - EMAIL_WEBMASTER=por314ug@gmail.com
      - EMAIL_FROM=por314ug@gmail.com
      - EMAIL_RETURN_PATH=por314ug@gmail.com
      # Modified default values
      - MYSQL_HOST=db
      - MYSQL_DATABASE=bugtracker
      - MYSQL_USER=mantis
      - MYSQL_PASSWORD=mantis
    # To customize options create `config_inc_addon.php` and uncomment lines below, the file will be included from the main config.
    #volumes:
    #  - ./config_inc_addon.php:/var/www/html/config/config_inc_addon.php
    depends_on:
      - db
    restart: always

  db:
    image: mysql:5.7
    container_name: mantis_db
    ports:
      - "3310:3306"
    volumes:
      - ./db_data:/var/lib/mysql
    environment:
      # Change root password before first run
      - MYSQL_ROOT_PASSWORD=2023root2023
      - MYSQL_DATABASE=bugtracker
      - MYSQL_USER=mantis
      - MYSQL_PASSWORD=mantis
    # Set default collation (For Mantis to warn about latin1)
    command: ['mysqld', '--character-set-server=utf8mb4', '--collation-server=utf8mb4_unicode_ci']
